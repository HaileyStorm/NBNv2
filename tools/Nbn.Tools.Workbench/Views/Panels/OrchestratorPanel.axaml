<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:Nbn.Tools.Workbench.ViewModels"
             x:Class="Nbn.Tools.Workbench.Views.Panels.OrchestratorPanel"
             x:DataType="vm:OrchestratorPanelViewModel">
  <ScrollViewer HorizontalScrollBarVisibility="Disabled">
    <StackPanel Spacing="16">
      <Border Classes="card">
        <Grid ColumnDefinitions="*,Auto" ColumnSpacing="16">
          <StackPanel Spacing="6">
            <TextBlock Text="Settings Monitor" Classes="card-title" />
            <TextBlock Text="Remote registry + live settings feed." Classes="card-subtitle" />
            <StackPanel Orientation="Horizontal" Spacing="8">
              <Button Content="Refresh" Command="{Binding RefreshCommand}" Classes="accent" />
            </StackPanel>
          </StackPanel>
          <StackPanel Grid.Column="1" Spacing="4" HorizontalAlignment="Right">
            <TextBlock Text="Status" Classes="chip" />
            <TextBlock Text="{Binding StatusMessage}" Classes="muted" />
          </StackPanel>
        </Grid>
      </Border>

      <Border Classes="card">
        <StackPanel Spacing="10">
          <TextBlock Text="Endpoints" Classes="card-title" />
          <Grid ColumnDefinitions="Auto,*,Auto,*,Auto,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto" ColumnSpacing="12" RowSpacing="6">
            <TextBlock Text="IO Host" Classes="muted" />
            <TextBox Grid.Column="1" Text="{Binding Connections.IoHost}" Width="160" />
            <TextBlock Grid.Column="2" Text="IO Port" Classes="muted" />
            <TextBox Grid.Column="3" Text="{Binding Connections.IoPortText}" Width="90" />
            <TextBlock Grid.Column="4" Text="Gateway" Classes="muted" />
            <TextBox Grid.Column="5" Text="{Binding Connections.IoGateway}" Width="140" />

            <TextBlock Grid.Row="1" Text="Obs Host" Classes="muted" />
            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Connections.ObsHost}" Width="160" />
            <TextBlock Grid.Row="1" Grid.Column="2" Text="Obs Port" Classes="muted" />
            <TextBox Grid.Row="1" Grid.Column="3" Text="{Binding Connections.ObsPortText}" Width="90" />
            <TextBlock Grid.Row="1" Grid.Column="4" Text="Debug Hub" Classes="muted" />
            <TextBox Grid.Row="1" Grid.Column="5" Text="{Binding Connections.DebugHub}" Width="140" />

            <TextBlock Grid.Row="2" Text="HiveMind Host" Classes="muted" />
            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Connections.HiveMindHost}" Width="160" />
            <TextBlock Grid.Row="2" Grid.Column="2" Text="HiveMind Port" Classes="muted" />
            <TextBox Grid.Row="2" Grid.Column="3" Text="{Binding Connections.HiveMindPortText}" Width="90" />
            <TextBlock Grid.Row="2" Grid.Column="4" Text="HiveMind Name" Classes="muted" />
            <TextBox Grid.Row="2" Grid.Column="5" Text="{Binding Connections.HiveMindName}" Width="140" />

            <TextBlock Grid.Row="3" Text="Settings Host" Classes="muted" />
            <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding Connections.SettingsHost}" Width="160" />
            <TextBlock Grid.Row="3" Grid.Column="2" Text="Settings Port" Classes="muted" />
            <TextBox Grid.Row="3" Grid.Column="3" Text="{Binding Connections.SettingsPortText}" Width="90" />
            <TextBlock Grid.Row="3" Grid.Column="4" Text="Settings Name" Classes="muted" />
            <TextBox Grid.Row="3" Grid.Column="5" Text="{Binding Connections.SettingsName}" Width="140" />

            <TextBlock Grid.Row="4" Grid.Column="4" Text="Viz Hub" Classes="muted" />
            <TextBox Grid.Row="4" Grid.Column="5" Text="{Binding Connections.VizHub}" Width="140" />
          </Grid>

          <StackPanel Orientation="Horizontal" Spacing="10">
            <WrapPanel>
              <StackPanel Orientation="Horizontal" Spacing="6" Margin="0,0,12,8">
                <Border Classes="chip"
                        Background="{Binding Connections.IoChipBackground}"
                        BorderBrush="{Binding Connections.IoChipBorder}">
                  <TextBlock Text="{Binding Connections.IoStatusLabel}" />
                </Border>
                <TextBlock Text="{Binding Connections.IoStatus}" Classes="muted" VerticalAlignment="Center" />
              </StackPanel>
              <StackPanel Orientation="Horizontal" Spacing="6" Margin="0,0,12,8">
                <Border Classes="chip"
                        Background="{Binding Connections.ObsChipBackground}"
                        BorderBrush="{Binding Connections.ObsChipBorder}">
                  <TextBlock Text="{Binding Connections.ObsStatusLabel}" />
                </Border>
                <TextBlock Text="{Binding Connections.ObsStatus}" Classes="muted" VerticalAlignment="Center" />
              </StackPanel>
              <StackPanel Orientation="Horizontal" Spacing="6" Margin="0,0,12,8">
                <Border Classes="chip"
                        Background="{Binding Connections.SettingsChipBackground}"
                        BorderBrush="{Binding Connections.SettingsChipBorder}">
                  <TextBlock Text="{Binding Connections.SettingsStatusLabel}" />
                </Border>
                <TextBlock Text="{Binding Connections.SettingsStatus}" Classes="muted" VerticalAlignment="Center" />
              </StackPanel>
              <StackPanel Orientation="Horizontal" Spacing="6" Margin="0,0,12,8">
                <Border Classes="chip"
                        Background="{Binding Connections.HiveMindChipBackground}"
                        BorderBrush="{Binding Connections.HiveMindChipBorder}">
                  <TextBlock Text="{Binding Connections.HiveMindStatusLabel}" />
                </Border>
                <TextBlock Text="{Binding Connections.HiveMindStatus}" Classes="muted" VerticalAlignment="Center" />
              </StackPanel>
            </WrapPanel>
          </StackPanel>
        </StackPanel>
      </Border>

      <Border Classes="card">
        <StackPanel Spacing="8">
          <TextBlock Text="Local Launch" Classes="card-title" />
          <Grid ColumnDefinitions="Auto,Auto,Auto,*" RowDefinitions="Auto,Auto,Auto,Auto" ColumnSpacing="10" RowSpacing="6">
            <TextBlock Text="SettingsMonitor" Classes="muted" />
            <Button Grid.Column="1" Content="Start" Command="{Binding StartSettingsMonitorCommand}" Classes="accent" />
            <Button Grid.Column="2" Content="Stop" Command="{Binding StopSettingsMonitorCommand}" />
            <TextBlock Grid.Column="3" Text="{Binding SettingsLaunchStatus}" Classes="muted" VerticalAlignment="Center" />

            <TextBlock Grid.Row="1" Text="HiveMind" Classes="muted" />
            <Button Grid.Row="1" Grid.Column="1" Content="Start" Command="{Binding StartHiveMindCommand}" Classes="accent" />
            <Button Grid.Row="1" Grid.Column="2" Content="Stop" Command="{Binding StopHiveMindCommand}" />
            <TextBlock Grid.Row="1" Grid.Column="3" Text="{Binding HiveMindLaunchStatus}" Classes="muted" VerticalAlignment="Center" />

            <TextBlock Grid.Row="2" Text="IO Gateway" Classes="muted" />
            <Button Grid.Row="2" Grid.Column="1" Content="Start" Command="{Binding StartIoCommand}" Classes="accent" />
            <Button Grid.Row="2" Grid.Column="2" Content="Stop" Command="{Binding StopIoCommand}" />
            <TextBlock Grid.Row="2" Grid.Column="3" Text="{Binding IoLaunchStatus}" Classes="muted" VerticalAlignment="Center" />

            <TextBlock Grid.Row="3" Text="Observability" Classes="muted" />
            <Button Grid.Row="3" Grid.Column="1" Content="Start" Command="{Binding StartObsCommand}" Classes="accent" />
            <Button Grid.Row="3" Grid.Column="2" Content="Stop" Command="{Binding StopObsCommand}" />
            <TextBlock Grid.Row="3" Grid.Column="3" Text="{Binding ObsLaunchStatus}" Classes="muted" VerticalAlignment="Center" />
          </Grid>
        </StackPanel>
      </Border>

      <Border Classes="card">
        <StackPanel Spacing="8">
          <TextBlock Text="Local Demo" Classes="card-title" />
          <TextBlock Text="Launch HiveMind, DemoBrainHost, RegionHost, IO Gateway, and Observability for quick validation." Classes="card-subtitle" />
          <StackPanel Orientation="Horizontal" Spacing="8">
            <Button Content="Start Demo" Command="{Binding StartDemoCommand}" Classes="accent" />
            <Button Content="Stop Demo" Command="{Binding StopDemoCommand}" />
            <TextBlock Text="{Binding DemoStatus}" Classes="muted" VerticalAlignment="Center" />
          </StackPanel>
        </StackPanel>
      </Border>

      <Grid ColumnDefinitions="*,*" ColumnSpacing="16">
        <Border Classes="card" Grid.Column="0">
          <StackPanel Spacing="8">
            <TextBlock Text="Nodes" Classes="card-title" />
            <ItemsControl ItemsSource="{Binding Nodes}">
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <Border Classes="row">
                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="8">
                      <Border Classes="pill">
                        <TextBlock Text="{Binding Status}" />
                      </Border>
                      <StackPanel Grid.Column="1">
                        <TextBlock Text="{Binding LogicalName}" Classes="row-title" />
                        <TextBlock Text="{Binding Address}" Classes="muted" />
                        <TextBlock Text="{Binding RootActor}" Classes="muted" />
                      </StackPanel>
                      <TextBlock Grid.Column="2" Text="{Binding LastSeen}" Classes="muted" HorizontalAlignment="Right" />
                    </Grid>
                  </Border>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
          </StackPanel>
        </Border>
        <Border Classes="card" Grid.Column="1">
          <StackPanel Spacing="8">
            <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
              <TextBlock Text="Settings" Classes="card-title" />
              <Button Grid.Column="1" Content="Apply" Command="{Binding ApplySettingsCommand}" Classes="accent" />
            </Grid>
            <ScrollViewer MaxHeight="280" HorizontalScrollBarVisibility="Disabled">
              <ItemsControl ItemsSource="{Binding Settings}">
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                  <Grid ColumnDefinitions="2*,Auto,Auto" ColumnSpacing="12" Margin="0,4">
                      <TextBlock Text="{Binding Key}" Classes="row-title" TextWrapping="Wrap" />
                      <TextBox Grid.Column="1" Text="{Binding Value}" Width="96" />
                      <TextBlock Grid.Column="2" Text="{Binding Updated}" Classes="muted" VerticalAlignment="Center" />
                  </Grid>
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>
            </ScrollViewer>
          </StackPanel>
        </Border>
      </Grid>

      <Border Classes="card">
        <StackPanel Spacing="8">
          <TextBlock Text="Terminations" Classes="card-title" />
          <ItemsControl ItemsSource="{Binding Terminations}">
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <Grid ColumnDefinitions="Auto,*,Auto,Auto" ColumnSpacing="12" Margin="0,4">
                  <TextBlock Text="{Binding Time}" Classes="muted" />
                  <TextBlock Grid.Column="1" Text="{Binding BrainId}" Classes="row-title" />
                  <Border Grid.Column="2" Classes="pill">
                    <TextBlock Text="{Binding Reason}" />
                  </Border>
                  <TextBlock Grid.Column="3" Text="{Binding EnergyRemaining}" Classes="muted" />
                </Grid>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </StackPanel>
      </Border>
    </StackPanel>
  </ScrollViewer>
</UserControl>
